webpackJsonp([9],{1163:function(t,e,a){var s=a(1164);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a(664)("11ac34c9",s,!0)},1164:function(t,e,a){e=t.exports=a(663)(!1),e.push([t.i,"",""])},1165:function(t,e,a){"use strict";var s=a(739);e.a={name:"PerformanceAppraisal",mixins:[s.a],data:function(){var t=[];return t.push(this.makeRow(1)),t.push(this.makeRow(2)),t.push(this.makeRow(3)),{appraisalDate:"",form:{id:"",appraisalDate:"",tasks:t},rules:{workContent:this.$checkRules.appraisal.workContent,weight:this.$checkRules.appraisal.weight,selfRated:this.$checkRules.appraisal.selfRated,appraisalDate:this.$checkRules.appraisal.appraisalDate}}},computed:{canDelete:function(){return this.form.tasks.length>1},sumWeight:function(){var t=0;return this.form.tasks.forEach(function(e){isNaN(e.weight)||(t=t.add(parseFloat(e.weight)||0))}),t},sumSelfRated:function(){var t=0;return this.form.tasks.forEach(function(e){isNaN(e.selfRated)||(t=t.add(parseFloat(e.selfRated)||0))}),t}},created:function(){var t=this,e=this.$route.query.id;this.$lodash.isEmpty(e)||this.$service.personal.detailPerformanceAppraisal({id:this.$route.query.id}).then(function(e){t.$lodash.assign(t.form,e),t.appraisalDate=t.$dateUtils.parseDate(t.form.appraisalDate+"-01")})},methods:{makeRow:function(t){return{sortNo:t,workContent:"",targetContent:"",completion:"",weight:"",selfRated:""}},addTask:function(){this.form.tasks.push(this.makeRow(this.form.tasks.length+1))},delTask:function(){this.form.tasks.splice(this.form.tasks.length-1,1)},save:function(t){var e=this;this.$refs.form.validate(function(a){a?e.$service.apply.savePerformanceAppraisal(e.form).then(function(t){e.form.id=t.data.id}).finally(function(){t.isLoading(!1)}):t.isLoading(!1)})},submit:function(t){var e=this;if(85!==this.sumWeight)return this.$alert("权重之和应该为85","提示"),void t.isLoading(!1);this.$refs.form.validate(function(a){a?e.$confirm("提交后将不可修改，请确认是否提交？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$service.apply.submitPerformanceAppraisal(e.form).then(function(){e.$router.replace("/personal/performanceAppraisal")}).finally(function(){t.isLoading(!1)})}).catch(function(){t.isLoading(!1)}):t.isLoading(!1)})}}}},1166:function(t,e,a){"use strict";var s=function(){var t=this,e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"space-p"},[s("section",[s("div",{staticClass:"space-m-b"},[s("el-button",{attrs:{type:"warning"},on:{click:e.addTask}},[e._v("新增任务")]),e._v(" "),s("el-button",{attrs:{type:"danger",disabled:!e.canDelete},on:{click:e.delTask}},[e._v("删除任务")])],1),e._v(" "),s("el-form",{ref:"form",attrs:{model:e.form}},[s("table",{staticClass:"oa-table-form",staticStyle:{width:"100%"},attrs:{border:"0",cellpadding:"0",cellspacing:"0"}},[s("colgroup",{attrs:{width:"100"}}),e._v(" "),s("colgroup",{attrs:{width:"60",align:"center"}}),e._v(" "),s("colgroup",{attrs:{width:"15%"}},[s("col",{attrs:{width:"110"}}),s("col")]),e._v(" "),s("thead",[s("tr",{staticClass:"oa-table__title"},[s("td",{attrs:{colspan:"10"}},[e._v("绩效合约/考核表（员工层级适用）")])]),e._v(" "),s("tr",{staticClass:"oa-table__info"},[s("td",{attrs:{colspan:"2"}},[e._v("姓名："+e._s(e.userInfo.realName))]),e._v(" "),s("td",{attrs:{colspan:"2"}},[e._v("部门："+e._s(e.userInfo.departments))]),e._v(" "),s("td",{attrs:{colspan:"3"}},[e._v("岗位职务："+e._s(e.userInfo.positionLevelStr))]),e._v(" "),s("td",{attrs:{colspan:"2"}},[e._v("考核期：\n            "),s("el-form-item",{attrs:{prop:"appraisalDate",rules:e.rules.appraisalDate}},[s("el-date-picker",{attrs:{clearable:!1,type:"month",format:"yyyy年MM月",placeholder:"选择日期"},on:{change:function(a){return e.form.appraisalDate=t.$lodash.isEmpty(a)?"":e.appraisalDate.format("yyyy-MM")}},model:{value:e.appraisalDate,callback:function(t){e.appraisalDate=t},expression:"appraisalDate"}})],1)],1)]),e._v(" "),s("tr",{staticClass:"oa-table__header"},[s("td",[e._v("考核维度")]),e._v(" "),s("td",[e._v("序号")]),e._v(" "),s("td",{attrs:{colspan:"2"}},[e._v("工作任务内容")]),e._v(" "),s("td",{attrs:{colspan:"2"}},[e._v("目标要求及评价标准")]),e._v(" "),s("td",[e._v("完成情况")]),e._v(" "),s("td",[e._v("权重（%）")]),e._v(" "),s("td",[e._v("自我评分")])])]),e._v(" "),s("tbody",[e._l(e.form.tasks,function(t,a){return s("tr",[0===a?s("td",{attrs:{rowspan:e.form.tasks.length}},[e._v("任务绩效(85%)")]):e._e(),e._v(" "),s("td",[e._v(e._s(t.sortNo))]),e._v(" "),s("td",{attrs:{colspan:"2"}},[s("el-form-item",{attrs:{prop:"tasks["+a+"].workContent",rules:e.rules.workContent}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:1}},model:{value:t.workContent,callback:function(a){e.$set(t,"workContent",a)},expression:"item.workContent"}})],1)],1),e._v(" "),s("td",{attrs:{colspan:"2"}},[s("el-form-item",[s("el-input",{attrs:{type:"textarea",autosize:{minRows:1}},model:{value:t.targetContent,callback:function(a){e.$set(t,"targetContent",a)},expression:"item.targetContent"}})],1)],1),e._v(" "),s("td",[s("el-form-item",[s("el-input",{staticClass:"oa-input-widthx",attrs:{type:"textarea",autosize:{minRows:1}},model:{value:t.completion,callback:function(a){e.$set(t,"completion",a)},expression:"item.completion"}})],1)],1),e._v(" "),s("td",[s("el-form-item",{attrs:{prop:"tasks["+a+"].weight",rules:e.rules.weight}},[s("el-input",{staticClass:"oa-input-widthx",model:{value:t.weight,callback:function(a){e.$set(t,"weight",a)},expression:"item.weight"}})],1)],1),e._v(" "),s("td",[s("el-form-item",{attrs:{prop:"tasks["+a+"].selfRated",rules:e.rules.selfRated}},[s("el-input",{staticClass:"oa-input-widthx",model:{value:t.selfRated,callback:function(a){e.$set(t,"selfRated",a)},expression:"item.selfRated"}})],1)],1)])}),e._v(" "),s("tr",[s("td",{attrs:{colspan:"7",align:"center"}},[s("strong",[e._v("合计")])]),e._v(" "),s("td",{attrs:{colspan:"1"}},[e._v(e._s(e.sumWeight))]),e._v(" "),s("td",{attrs:{colspan:"1"}},[e._v(e._s(e.sumSelfRated))])])],2)])]),e._v(" "),s("div",{staticClass:"space-m-t text-center"},[s("c-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),s("c-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")]),e._v(" "),s("el-button",{attrs:{type:"default"},on:{click:function(t){e.$router.back()}}},[e._v("返回")])],1)],1)])},n=[],r={render:s,staticRenderFns:n};e.a=r},707:function(t,e,a){"use strict";function s(t){a(1163)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(1165),r=a(1166),i=a(68),o=s,l=i(n.a,r.a,!1,o,null,null);e.default=l.exports},739:function(t,e,a){"use strict";var s=a(101),n=a.n(s),r=a(149),i=a.n(r),o=a(222),l=a(104);e.a={computed:i()({},Object(o.c)("user",["userInfo","departments"])),watch:{userInfo:function(){this.$emit("$_userInfoOk")},departments:function(){this.$emit("$_departmentsOk")}},methods:i()({},Object(o.b)("user",{setUserInfo:l.a}),{$_getUserInfo:function(){var t=this;return new n.a(function(e){t.$lodash.isEmpty(t.userInfo)?t.$once("$_userInfoOk",function(){e(t.userInfo)}):e(t.userInfo)})},$_getDepartments:function(){var t=this;return new n.a(function(e){t.$lodash.isEmpty(t.departments)?t.$once("$_departmentsOk",function(){e(t.departments)}):e(t.departments)})}})}}});